{"title":"问题精析：蒙皮原理","date":"2020-08-05T18:07:43.000Z","date_formatted":{"ll":"Aug 6, 2020","L":"08/06/2020","MM-DD":"08-06"},"link":"2020/08/06/问题精析：蒙皮原理","tags":["计算机图形学"],"categories":["问题精析"],"updated":"2020-08-06T03:40:25.567Z","content":"<script type=\"text/javascript\" async src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML\"></script>\n<h2 id=\"概念\">概念<a title=\"#概念\" href=\"#概念\"></a></h2>\n<p>  骨架是一个概念结构，与之关联的实际三维几何体是角色的多边形网格。由骨骼运动变形的多边形网格通常称为蒙皮。本节介绍皮肤如何平滑变形。</p>\n<h2 id=\"数学原理\">数学原理<a title=\"#数学原理\" href=\"#数学原理\"></a></h2>\n<p>  我们先假设一个顶点只属于一根骨骼，这会导致不自然的皮肤变形。下图展示了这一情况，其中v2，v3只属于前臂而v1只属于上臂。</p>\n<img src=\"/2020/08/06/%E9%97%AE%E9%A2%98%E7%B2%BE%E6%9E%90%EF%BC%9A%E8%92%99%E7%9A%AE%E5%8E%9F%E7%90%86/1.png\" class=\"\">\n<p>  通过使多个骨骼影响一个顶点，然后混合结果，而不是将一个顶点绑定到单个骨骼，可以缓解该问题。为此，为每个影响顶点的骨骼指定混合权重。权重描述了骨骼对顶点变形位置的贡献程度。下图显示了一个例子，其中上臂对v1的位置贡献70%，前臂贡献30%。这看起来很合理，因为V1更靠近上臂，因此受上臂的影响更大。对于给v2和v3的权重也可以进行类似的讨论。</p>\n<img src=\"/2020/08/06/%E9%97%AE%E9%A2%98%E7%B2%BE%E6%9E%90%EF%BC%9A%E8%92%99%E7%9A%AE%E5%8E%9F%E7%90%86/2.png\" class=\"\">\n<p>  右图说明了混合过程，其中\\(v_1^u\\),\\(v_2^u\\)和\\(v_3^u\\)表示由上臂运动变换的顶点位置，\\(v_1^f\\)、\\(v_2^f\\)和\\(v_3^f\\)表示前臂的顶点位置。使用图中给出的混合权重对每对\\(v_i^u\\)和\\(v_i^f\\)进行线性插值。结果是\\(v_i^′\\)。连接\\(v_i^′\\)可以生成更平滑的皮肤。这种技术称为顶点混合或蒙皮。<br>\n  下图中，假设除了前臂，手的骨骼也会影响v5，其拥有一个手坐标系下的坐标，记为v6，坐标为（-1，0）。</p>\n<img src=\"/2020/08/06/%E9%97%AE%E9%A2%98%E7%B2%BE%E6%9E%90%EF%BC%9A%E8%92%99%E7%9A%AE%E5%8E%9F%E7%90%86/3.png\" class=\"\">\n<p>  根据骨骼层级及其坐标变化，我们知道v5和v6是默认姿势下的顶点坐标分别与变换矩阵相乘得到的。<br>\n$$<br>\nv_5 = M_{5,d}^{-1}v_d<br>\n$$<br>\n$$<br>\nv_6 = M_{6,d}^{-1}v_d<br>\n$$<br>\n  假设前臂旋转−90°。然后，v5和v6分别通过\\(M_{5,w}\\),\\(M_{6,w}\\)转换到世界空间，并使用预先定义的权重w5和w6进行混合:<br>\n$$<br>\nw_5M_{5,w}v_5 + w_6M_{6,w}v_6<br>\n$$<br>\n  组合上面两等式<br>\n$$<br>\nw_5M_{5,w}M_{5,d}^{-1}v_d + w_6M_{6,w}M_{6,d}^{-1}v_d<br>\n$$<br>\n  假设n个骨骼影响一个顶点，它们的权重总和为1。然后，推广方程定义动画姿势的世界空间顶点vw：<br>\n$$<br>\nv_w = \\sum_{i = 1}^{n}w_iM_{i,w}M_{i,d}^{-1}v_d<br>\n$$</p>\n<h2 id=\"参考资料\">参考资料<a title=\"#参考资料\" href=\"#参考资料\"></a></h2>\n<p>   1. <a href=\"\">JungHyun Han - 3D Graphics for Game Programming-CRC Press (2011)</a></p>\n","prev":{"title":"问题精析：帧动画中的蒙皮","link":"2020/08/06/问题精析：帧动画中的蒙皮"},"next":{"title":"问题9：字符串轮转","link":"2020/08/05/问题9：字符串轮转"},"plink":"http://Ssssshinji.github.io/2020/08/06/问题精析：蒙皮原理/","toc":[{"id":"概念","title":"概念","index":"1"},{"id":"数学原理","title":"数学原理","index":"2"},{"id":"参考资料","title":"参考资料","index":"3"}]}