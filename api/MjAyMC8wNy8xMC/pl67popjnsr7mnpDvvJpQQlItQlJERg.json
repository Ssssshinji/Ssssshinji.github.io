{"title":"问题精析：PBR:BRDF","date":"2020-07-10T07:53:16.000Z","date_formatted":{"ll":"Jul 10, 2020","L":"07/10/2020","MM-DD":"07-10"},"link":"2020/07/10/问题精析：PBR-BRDF","tags":["计算机图形学"],"categories":["问题精析"],"updated":"2020-07-10T12:10:35.590Z","content":"<script type=\"text/javascript\" async src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML\"></script>\n<p>  我们看到一个表面，实际上是周围环境的光照射到表面上，然后表面将一部分光反射到我们眼睛里。双向反射分布函数BRDF（Bidirectional Reflectance Distribution Function）就是描述表面入射光和反射光关系的。BRDF就是一个描述光如何从给定的两个方向（入射光方向l和出射方向v）在表面进行反射的函数。<br>\n  BRDF的精确定义是出射辐射率的微分（differential outgoing radiance）和入射辐照度的微分（differential incoming irradiance）之比：<br>\n$$<br>\nf(l,v) = \\frac{dL_o(v)}{dE(l)}<br>\n$$</p>\n<blockquote>\n<p>其中f就是BRDF，l是入射光方向，v是观察方向，也就是我们关心的反射光方向。<br>\n\\(f(l,v)\\)是表面反射到\\(v\\)方向的反射光的微分辐射率。表面反射到\\(v\\)方向的反射光的辐射率为\\(L_o(v)\\)，来自于表面上半球所有方向的入射光线的贡献，而微分辐射率\\(dL_o(v)\\)特指来自方向\\(l\\)的入射光贡献的反射辐射率。<br>\n\\(dE(l)\\)是表面上来自入射光方向\\(l\\)的微分辐照度。表面接收到的辐照度为\\(E\\)，来自上半球所有方向的入射光线的贡献，而微分辐照度\\(dE(l)\\)特指来自于方向\\(l\\)的入射光。</p>\n</blockquote>\n<h2 id=\"相关物理量（辐射度量学）\">相关物理量（辐射度量学）<a title=\"#相关物理量（辐射度量学）\" href=\"#相关物理量（辐射度量学）\"></a></h2>\n<h3 id=\"辐射通量/光通量-radiant-flux\">辐射通量/光通量 Radiant Flux<a title=\"#辐射通量/光通量-radiant-flux\" href=\"#辐射通量/光通量-radiant-flux\"></a></h3>\n<p>  功率（Power），单位瓦特（Watts），或者焦耳／秒。辐射度学中，辐射功率也被称为辐射通量（Radiant Flux）或者通量（Flux）。描述的是在单位时间穿过截面的光能，或每单位时间的辐射能量，通常用Φ来表示。<br>\n$$<br>\n\\phi = dQ/dt<br>\n$$<br>\n  其中的Q表示辐射能(Radiant energy)，单位是J，焦耳。</p>\n<h3 id=\"辐射强度/发光强度-radiant-intensity\">辐射强度/发光强度 Radiant Intensity<a title=\"#辐射强度/发光强度-radiant-intensity\" href=\"#辐射强度/发光强度-radiant-intensity\"></a></h3>\n<p>  指通过单位立体角的辐射通量。用符号I表示，单位\\(W \\cdot sr^-1\\)，瓦特每球面度。之所以引入辐射强度，是因为有时候要度量通过一个点的通量的密度，但因为点的面积是0，无法使用辐照度。<strong>辐射强度不会随距离变化而变化，不像点光源的辐照度会随距离增大而衰减，这是因为立体角不会随距离变化而变化。</strong><br>\n$$<br>\nI = d\\phi/d\\omega<br>\n$$</p>\n<h3 id=\"辐照度/辉度irradiance\">辐照度/辉度Irradiance<a title=\"#辐照度/辉度irradiance\" href=\"#辐照度/辉度irradiance\"></a></h3>\n<p>  辐照度（Irradiance，又译作辉度，辐射照度，用符号E表示），指入射表面的辐射通量，即单位时间内到达单位面积的辐射通量，或到达单位面积的辐射通量，也就是辐射通量对于面积的密度，用符号E表示，单位\\(W \\cdot m^-2\\)，瓦特每平方米。<br>\n$$<br>\nE = d\\phi/dA<br>\n$$<br>\n也可以写成辐射率(Radiance)在入射光所形成半球上的积分：<br>\n$$<br>\n\\frac{d\\phi}{dA} = E = \\int_{\\Omega} L(\\omega)cos\\theta d\\omega<br>\n$$<br>\n<img src=\"https://pic2.zhimg.com/80/749a01b706ea4b07f0d3dbaaccf84401_720w.jpg\" alt=\"\"></p>\n<p>  假定不垂直于光线传输方向的表面面积为\\(A\\)，将它投影到垂直于光线方向得到一个虚拟表面，这个虚拟表面的面积为\\(A^ \\bot = Acos \\theta _i\\)，通过这两个面积的通量是相同的，均为\\(\\phi\\)，则表面接收到的辐照度\\(E = \\phi/A\\)，虚拟表面上的辐照度\\(E_L = \\phi/Acos \\theta_i\\)，于是\\(E = E_Lcos \\theta_i\\)。</p>\n<h3 id=\"辐射率/光亮度radiance\">辐射率/光亮度Radiance<a title=\"#辐射率/光亮度radiance\" href=\"#辐射率/光亮度radiance\"></a></h3>\n<p>  我们常需要度量从一个微小面积表面出发，射向某个微小方向的通量（或者来自某个微小方向，照射到微小面积表面的通量），辐射率就是度量这种情况的量。辐射率（Radiance），指每单位面积每单位立体角的辐射通量密度。用符号L表示，单位\\(W \\cdot sr^-1 \\cdot m^-2\\)。需要注意的是，辐射率使用物体表面沿目标方向上的投影面积，而不是面积。<br>\n$$<br>\nL = \\frac{d^2\\phi}{dAcos \\theta d\\omega}<br>\n$$</p>\n<p>  辐射率实际上可以看成是我们眼睛看到（或相机拍到）的物体上一点的颜色。在基于物理着色时，计算表面一点的颜色就是计算它的辐射率。<strong>辐射率不会随距离变化而衰减</strong>，这和我们日常感受一致，在没有雾霾的干扰时，我们看到的物体表面上一点的颜色并不会随距离变化而变化。为什么辐照度会随距离增大而衰减，但是我们看到的颜色却不会衰减呢？这是因为随着距离变大，我们看到的物体上的一块区域到达视网膜的通量密度会变小，同时这块区域在视网膜表面上的立体角也会变小，正好抵消了通量密度的变化。</p>\n<h2 id=\"lambert模型的brdf\">Lambert模型的BRDF<a title=\"#lambert模型的brdf\" href=\"#lambert模型的brdf\"></a></h2>\n<p><img src=\"https://images2017.cnblogs.com/blog/543533/201708/543533-20170812122346273-1679329459.png\" alt=\"\"><br>\n  如图，设Lambert面元获得入射照度Ei，各方向均匀释放亮度，每个方向释放的亮度都是Lo。<br>\n又设此表面反射率为Albedo，根据反射率定义:<br>\n$$<br>\n\\begin{align}<br>\nAlbedo &amp;= Eo/Ei \\\\&amp;= \\frac{\\int_{\\Omega} L(\\omega)cos\\theta d\\omega}{E_i} \\\\&amp;=\\frac{Albedo}{\\pi}<br>\n\\end{align}<br>\n$$<br>\n所以<br>\n$$<br>\nbrdf=Lo/Ei=Albedo/pi<br>\n$$<br>\n  半球cos积分等于pi的计算过程：作代换dw=sin(theta)<em>dtheta</em>dphi，则<br>\n$$<br>\n\\begin{align}<br>\n\\int_{\\Omega} cos\\theta d\\omega &amp;= \\int_{0}^{2\\pi}d\\phi \\int_{0}^{\\pi/2}cos\\theta sin\\theta d\\theta<br>\n\\end{align}<br>\n$$</p>\n<h2 id=\"参考资料\">参考资料<a title=\"#参考资料\" href=\"#参考资料\"></a></h2>\n<p>   1. <a href=\"https://zhuanlan.zhihu.com/p/21376124\" target=\"_blank\">基于物理着色：BRDF</a><br>\n   1. <a href=\"https://www.zhihu.com/question/28476602/answer/41003204\" target=\"_blank\">brdf为什么要定义为一个单位是sr-1的量？</a><br>\n   1. <a href=\"https://www.cnblogs.com/wantnon/p/6954428.html\" target=\"_blank\">Lambert漫反射的BRDF</a></p>\n","next":{"title":"问题精析：PBR:三种反射模型","link":"2020/07/10/问题精析：PBR-三种反射模型"},"plink":"http://Ssssshinji.github.io/2020/07/10/问题精析：PBR-BRDF/","toc":[{"id":"相关物理量（辐射度量学）","title":"相关物理量（辐射度量学）","index":"1","children":[{"id":"辐射通量/光通量-radiant-flux","title":"辐射通量&#x2F;光通量 Radiant Flux","index":"1.1"},{"id":"辐射强度/发光强度-radiant-intensity","title":"辐射强度&#x2F;发光强度 Radiant Intensity","index":"1.2"},{"id":"辐照度/辉度irradiance","title":"辐照度&#x2F;辉度Irradiance","index":"1.3"},{"id":"辐射率/光亮度radiance","title":"辐射率&#x2F;光亮度Radiance","index":"1.4"}]},{"id":"lambert模型的brdf","title":"Lambert模型的BRDF","index":"2"},{"id":"参考资料","title":"参考资料","index":"3"}]}